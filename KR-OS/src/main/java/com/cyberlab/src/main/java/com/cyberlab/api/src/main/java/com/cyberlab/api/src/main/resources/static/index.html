<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Cyber Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    body{margin:0;background:#03060a;color:#cfeff3;font-family:"Roboto Mono",monospace;padding:20px}
    .container{display:grid;grid-template-columns:350px 1fr;grid-template-rows:1fr 150px;gap:16px;height:100vh}
    .panel{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:10px;padding:12px}
    .h1{font-size:14px;color:#0ff;margin-bottom:8px}
    .stat{font-size:22px;color:#0ff;font-weight:bold}
    .muted{color:#999;font-size:12px}
    .term-window{background:#0005;border-radius:8px;padding:10px;font-size:13px;overflow:auto;height:100%}
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <div class="h1">CPU</div>
      <div id="cpuVal" class="stat">--%</div>
      <canvas id="cpuChart"></canvas>
    </div>
    <div class="panel term-window">
      <div class="muted">PS C:\Users\cyber&gt;</div>
      <div id="log">Connecting...</div>
    </div>
    <div class="panel">
      <div class="h1">Network</div>
      <div id="ping" class="stat">-- ms</div>
      <canvas id="netChart"></canvas>
    </div>
    <div class="panel muted">github.com/you/cyber-dashboard</div>
  </div>

<script>
  const cpuChart = new Chart(document.getElementById('cpuChart'),{
    type:'line',
    data:{labels:[],datasets:[{data:[],borderColor:'#0ff',tension:0.25,fill:true,backgroundColor:'rgba(0,255,255,0.05)'}]},
    options:{animation:false,scales:{x:{display:false},y:{min:0,max:100,display:true}}}
  });
  const netChart = new Chart(document.getElementById('netChart'),{
    type:'line',
    data:{labels:[],datasets:[{data:[],borderColor:'#b86bff',tension:0.25,fill:true,backgroundColor:'rgba(184,107,255,0.05)'}]},
    options:{animation:false,scales:{x:{display:false},y:{min:0,max:20,display:true}}}
  });

  const log = document.getElementById('log');
  const cpuVal = document.getElementById('cpuVal');
  const pingVal = document.getElementById('ping');

  const es = new EventSource('/stream/telemetry');
  es.onmessage = e=>{
    const d=JSON.parse(e.data);
    cpuVal.textContent=Math.round(d.cpu)+'%';
    pingVal.textContent=(10+Math.floor(Math.random()*40))+' ms';
    push(cpuChart,d.ts,d.cpu);
    push(netChart,d.ts,d.netUp+d.netDown);
    log.textContent=`[${new Date(d.ts).toLocaleTimeString()}] CPU:${d.cpu.toFixed(1)}% MEM:${d.mem.toFixed(1)}% UP:${d.netUp} DOWN:${d.netDown}\n`+log.textContent;
  }
  function push(chart,ts,v){chart.data.labels.push('');chart.data.datasets[0].data.push(v);if(chart.data.labels.length>30){chart.data.labels.shift();chart.data.datasets[0].data.shift();}chart.update('none');}
</script>
</body>
</html>
